<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Image Recognition in Go using Tensorflow @ Alex Pliutau's Blog</title>
        <meta name="description" content="This is a text version of this video: packagemain #4: Image Recognition in Go using Tensorflow.
Tensorflow is a computation library that represents computations with graphs. Its core is implemented in C&#43;&#43; and there are also bindings for different languages, including Go.
In the last few years the field of machine learning has made tremendous progress on addressing the difficult problem of image recognition.
One of the challenges with machine learning is figuring out how to deploy trained models into production environments.">
        <meta name="keywords" content="go, golang, image-recognition, tensorflow, machine-learning, docker, alex pliutau, golang, go, programming, docker, swagger, git">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.52" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:title" content="Image Recognition in Go using Tensorflow">
<meta property="og:description" content="This is a text version of this video: packagemain #4: Image Recognition in Go using Tensorflow.
Tensorflow is a computation library that represents computations with graphs. Its core is implemented in C&#43;&#43; and there are also bindings for different languages, including Go.
In the last few years the field of machine learning has made tremendous progress on addressing the difficult problem of image recognition.
One of the challenges with machine learning is figuring out how to deploy trained models into production environments.">
<meta property="og:type" content="article">
<meta property="og:url" content="/image-recognition-in-go-using-tensorflow/">

<meta property="og:image" content="/IRiGuTF.jpg" />


        <link rel="stylesheet" href="/dist/styles.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        
		<link rel="shortcut icon" href="/favicon.ico">
		
			<script id="dsq-count-scr" src="//pliutau.disqus.com/count.js" async></script>
		
    </head>
    <body>
        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-72731922-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <a class="button-square button-social hint--top" data-hint="Twitter" title="Twitter" href="https://twitter.com/pliutau">
                                <i class="fa fa-twitter"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Youtube" title="Youtube" href="https://www.youtube.com/packagemain">
                                <i class="fa fa-youtube"></i>
                            </a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/plutov">
                                <i class="fa fa-github-alt"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Stack Overflow" title="Stack Overflow" href="https://stackoverflow.com/users/350294/pltvs">
                                <i class="fa fa-stack-overflow"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="LinkedIn" title="LinkedIn" href="https://linkedin.com/in/pltvs/">
                                <i class="fa fa-linkedin"></i>
                            </a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Email" title="Email" href="mailto:a.pliutau@gmail.com">
                                <i class="fa fa-envelope"></i>
                            </a>
                        
                        
                    </div>

                    <ul class="site-nav">
                        
    <li class="site-nav-item">
        <a title="Blog" href="/">Blog</a>
    </li>

    <li class="site-nav-item">
        <a title="About" href="/page/about/">About</a>
    </li>

    <li class="site-nav-item">
        <a title="Hire Me" href="/page/hire-me/">Hire Me</a>
    </li>

    <li class="site-nav-item">
        <a title="Subscribe" href="https://eepurl.com/cDoD09">Subscribe</a>
    </li>

    <li class="site-nav-item">
        <a title="Buy me a coffee" href="https://www.buymeacoffee.com/packagemain">Buy me a coffee</a>
    </li>

                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Image Recognition in Go using Tensorflow</h1>
    
    <p class="post-date">
        <span>Published <time datetime="2018-01-08"  itemprop="datePublished">Mon, Jan 8, 2018</time></span>
        <span>by</span>
        <span itemscope="" itemprop="author" itemtype="https://schema.org/Person">
            <span itemprop="name">
                <a href="https://pliutau.com" itemprop="url" rel="author">Alex Pliutau</a>
            </span>
        </span>
    </p>
</header>
		<footer class="post-footer clearfix share-middle">
    <div class="share">
	<a class="icon-twitter" href="https://twitter.com/share?text=Image%20Recognition%20in%20Go%20using%20Tensorflow&url=%2fimage-recognition-in-go-using-tensorflow%2f"
		onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
		<i class="fa fa-twitter"></i>
		<span class="hidden">Twitter</span>
	</a>

	<a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=%2fimage-recognition-in-go-using-tensorflow%2f"
		onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
		<i class="fa fa-facebook"></i>
		<span class="hidden">Facebook</span>
	</a>

	<a class="icon-google-plus" href="https://plus.google.com/share?url=%2fimage-recognition-in-go-using-tensorflow%2f"
	  onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
	  <i class="fa fa-google-plus"></i>
		<span class="hidden">Google+</span>
	</a>

	<a class="icon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&title=Image%20Recognition%20in%20Go%20using%20Tensorflow&url=%2fimage-recognition-in-go-using-tensorflow%2f&summary="
	   onclick="window.open(this.href, 'linkedin-share', 'width=554,height=481');return false;">
	   <i class="fa fa-linkedin"></i>
	   <span class="hidden">LinkedIn</span>
	</a>
</div>

</footer>

		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:100%;height:90px;margin-top:20px;margin-bottom:20px;"
     data-ad-client="ca-pub-9796117147060610"
     data-ad-slot="8595828683"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

        <div class="post-content clearfix" itemprop="articleBody">
    

    <p><img src="/IRiGuTF.jpg" alt="image_recognition_in_go_using_tensorflow" /></p>

<p>This is a text version of this video: <a href="https://youtu.be/P8MZ1Z2LHrw">packagemain #4: Image Recognition in Go using Tensorflow</a>.</p>

<p>Tensorflow is a computation library that represents computations with graphs. Its core is implemented in C++ and there are also bindings for different languages, including Go.</p>

<p>In the last few years the field of machine learning has made tremendous progress on addressing the difficult problem of image recognition.</p>

<p>One of the challenges with machine learning is figuring out how to deploy trained models into production environments. After training your model, you can &ldquo;freeze&rdquo; it and export it to be used in a production environment.</p>

<p>For some common-use-cases we&rsquo;re beginning to see organizations sharing their trained models, you can find some in the <a href="https://github.com/tensorflow/models">TensorFlow Models repo</a>.</p>

<p>In this article we&rsquo;ll use one of them, called <a href="https://github.com/tensorflow/models/tree/master/research/inception/inception">Inception</a> to recognize an image.</p>

<p>We&rsquo;ll build a small command line application that takes URL to an image as input and outputs labels in order.</p>

<p>First of all we need to install TensorFlow, and here Docker can be really helpful, because installation of Tensorflow may be complicated. There is a Docker image with Tensorflow, but without Go, so I found an image with Tensorflow plus Go to reduce the Dockerfile.</p>

<script type="application/javascript" src="//gist.github.com/plutov/285947413105cac01a19da4a1e6e6639.js"></script>

<p>Let&rsquo;s start with simple main.go which will parse command line arguments and download image from URL:</p>

<script type="application/javascript" src="//gist.github.com/plutov/ebd8dc8edde3b9e2b29edd899be6aca5.js"></script>

<p>And now we can build and run our program:</p>

<script type="application/javascript" src="//gist.github.com/plutov/a38f01b12250f23edf475bc88412d268.js"></script>

<p>Now we need to load our model. Model contains graph and labels in 2 files:</p>

<script type="application/javascript" src="//gist.github.com/plutov/0de9dc194bc15857db0c689ce0da4a5b.js"></script>

<p>Now finally we can start using tensorflow Go package.
To be able to work with our image we need to normalize it, because Inception model expects it to be in a certain format, it uses images from ImageNet, and they are 224x224. But that&rsquo;s a bit tricky. Let&rsquo;s see:</p>

<script type="application/javascript" src="//gist.github.com/plutov/b88486ac41678a88b8edc2332f936a1f.js"></script>

<p>All operations in TensorFlow Go are done with sessions, so we need to initialize, run and close them. In makeTransformImageGraph we define the rules of normalization.</p>

<p>We need to init one more session on our initial model graph to find matches:</p>

<script type="application/javascript" src="//gist.github.com/plutov/e0b0afbdfde3261232fa8af90008f849.js"></script>

<p>It will return list of probabilities for each label. What we need now is to loop over all probabilities and find label in <code>labels</code> slice. And print top 5.</p>

<script type="application/javascript" src="//gist.github.com/plutov/7580d3fc5623cdc7efeb44269004fec7.js"></script>

<p>That&rsquo;s it, we&rsquo;re able to test our image and find what program will say:</p>

<script type="application/javascript" src="//gist.github.com/plutov/a38f01b12250f23edf475bc88412d268.js"></script>

<p>Here we used pre-trained model but it&rsquo;s also possible to train our models from Go in TensorFlow, and I will definitely do a video about it.</p>

<p><a href="https://github.com/plutov/packagemain/tree/master/04-tensorflow-image-recognition">Full code of this program</a></p>

</div>

        <footer class="post-footer clearfix">
    
        <p class="post-tags">
            <span>Tagged:</span>
            
            
                <a href="/tags/go/">go</a>
                , 
            
                <a href="/tags/golang/">golang</a>
                , 
            
                <a href="/tags/image-recognition/">image-recognition</a>
                , 
            
                <a href="/tags/tensorflow/">tensorflow</a>
                , 
            
                <a href="/tags/machine-learning/">machine-learning</a>
                , 
            
                <a href="/tags/docker/">docker</a>
                
            
        </p>
    

    <div class="share">
	<a class="icon-twitter" href="https://twitter.com/share?text=Image%20Recognition%20in%20Go%20using%20Tensorflow&url=%2fimage-recognition-in-go-using-tensorflow%2f"
		onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
		<i class="fa fa-twitter"></i>
		<span class="hidden">Twitter</span>
	</a>

	<a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=%2fimage-recognition-in-go-using-tensorflow%2f"
		onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
		<i class="fa fa-facebook"></i>
		<span class="hidden">Facebook</span>
	</a>

	<a class="icon-google-plus" href="https://plus.google.com/share?url=%2fimage-recognition-in-go-using-tensorflow%2f"
	  onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
	  <i class="fa fa-google-plus"></i>
		<span class="hidden">Google+</span>
	</a>

	<a class="icon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&title=Image%20Recognition%20in%20Go%20using%20Tensorflow&url=%2fimage-recognition-in-go-using-tensorflow%2f&summary="
	   onclick="window.open(this.href, 'linkedin-share', 'width=554,height=481');return false;">
	   <i class="fa fa-linkedin"></i>
	   <span class="hidden">LinkedIn</span>
	</a>
</div>

</footer>

		<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{
		width:100%;
		border: 1px solid #dddbcc;
		border-radius: 3px;
		margin: 20px 0;
		background: #f1f0ea;
	}
	#mc_embed_signup .button { background: #f03838 !important; }
</style>
<div id="mc_embed_signup">
<form action="//pliutau.us15.list-manage.com/subscribe/post?u=48e0bc513d92114dd04b36ffa&amp;id=862c25c5fb" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<label for="mce-EMAIL">Get the latest posts delivered right to your inbox.</label>
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_48e0bc513d92114dd04b36ffa_862c25c5fb" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

        
    <div class="comments">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "pliutau" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>

        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:100%;height:90px;margin-top:20px;margin-bottom:20px;"
     data-ad-client="ca-pub-9796117147060610"
     data-ad-slot="8595828683"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

    </article>
</div>

                </div>
        </div>

        <footer class="footer">
            <div class="container">
                <p class="footer-copyright site-title-wrapper">
                    <span>&copy; 2018 Alex Pliutau. All rights reserved.</span>
                </p>
            </div>
        </footer>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
		<script type="text/javascript">
			hljs.initHighlightingOnLoad();
		</script>
    </body>
</html>

